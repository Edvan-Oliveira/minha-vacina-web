<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <h:outputStylesheet library="webjars" name="font-awesome/5.12.0/css/all.min-jsf.css"/>
    <h:outputStylesheet library="webjars" name="font-awesome/5.12.0/css/v4-shims.min-jsf.css"/>
    <h:outputStylesheet library="css" name="index.css"/>
</h:head>
<h:body>
    <f:metadata>
        <f:viewAction action="#{campanhaView.verificarUsuarioLogado}"/>
        <f:viewAction action="#{campanhaView.carregarDadosdaTela}"/>
    </f:metadata>

    <p:growl id="mensagem"/>

    <p:commandButton icon="fa fa-plus" value="Nova Campanha" onclick="PF('dlgCadastroCampanha').show()"/>

    <div class="tabela-campanhas">
        <h:form id="formTabCampanhas">
            <p:dataTable id="tabCampanhas" widgetVar="tabCampanhas" paginator="true" paginatorPosition="bottom"
                         emptyMessage="Nenhuma campanha encontrada" value="#{campanhaView.listaDeCampanhas}"
                         var="campanha">

                <p:column headerText="Nome" style="width: 20%">
                    <p:outputLabel value="#{campanha.nome}"/>
                </p:column>

                <p:column headerText="Data Início">
                    <p:outputLabel value="#{campanhaView.formatarDataParaVisualizacao(campanha.dataInicio)}"/>
                </p:column>

                <p:column headerText="Data Termino">
                    <p:outputLabel value="#{campanhaView.formatarDataParaVisualizacao(campanha.dataFim)}"/>
                </p:column>

                <p:column headerText="Idade Mínima">
                    <p:outputLabel value="#{campanhaView.formatarIdadeParaVisualizacao(campanha.idadeMinima)}"/>
                </p:column>

                <p:column headerText="Idade Máxima">
                    <p:outputLabel value="#{campanhaView.formatarIdadeParaVisualizacao(campanha.idadeMaxima)}"/>
                </p:column>

                <p:column headerText="Município">
                    <p:outputLabel value="#{campanha.municipio.nome}"/>
                </p:column>

                <p:column headerText="Vacina">
                    <p:outputLabel value="#{campanha.vacina.nome}"/>
                </p:column>

                <p:column headerText="Detalhes">
                    <p:commandButton icon="fa fa-align-justify" styleClass="icone-detalhe"/>
                </p:column>

                <p:column headerText="Editar">
                    <p:commandButton icon="fa fa-pencil" styleClass="icone-editar"/>
                </p:column>

                <p:column headerText="Finalizar">
                    <p:commandButton icon="fa fa-unlock" styleClass="icone-remover"/>
                </p:column>

            </p:dataTable>
        </h:form>
    </div>

    <p:dialog id="dlgCadastroCampanha" widgetVar="dlgCadastroCampanha" modal="true" resizable="false"
              header="Cadastro de Campanha" closable="false">
        <h:form id="formCadastroCampanha">
            <p:outputPanel styleClass="agrupamento-input">
                <p:outputLabel for="nome" value="Nome" styleClass="margin-label-bottom"/>
                <p:inputText id="nome" size="153" required="true" requiredMessage="Nome da campanha é obrigatório"
                             value="#{campanhaView.campanha.nome}"/>
            </p:outputPanel>
            <p:outputPanel styleClass="agrupamento-input">
                <p:outputPanel>
                    <p:outputLabel for="descricao" value="Descrição" styleClass="margin-label-bottom"/>
                    <p:inputTextarea id="descricao" autoResize="true" styleClass="campo-descricao" required="true"
                                     requiredMessage="Descrição da campanha é obrigatório"
                                     value="#{campanhaView.campanha.descricao}"/>
                </p:outputPanel>
            </p:outputPanel>

            <div class="agrupar-select">
                <div class="componente-flex">
                    <p:outputLabel for="municipioCadastro" value="Município" styleClass="margin-label-bottom"/>
                    <p:selectOneMenu id="municipioCadastro" filter="true" styleClass="selects"
                                     filterMatchMode="contains" required="true"
                                     requiredMessage="Município da campanha é obrigatório"
                                     value="#{campanhaView.campanha.municipio.id}">
                        <f:selectItem itemLabel="Selecione um município" itemValue="#{null}"/>
                        <f:selectItems value="#{campanhaView.listaDeMunicipios}" var="municipio"
                                       itemLabel="#{municipio.nome}" itemValue="#{municipio.id}"/>
                    </p:selectOneMenu>
                </div>

                <div class="componente-flex">
                    <p:outputLabel for="vacinaCadastro" value="Vacina" styleClass="margin-label-bottom"/>
                    <p:selectOneMenu id="vacinaCadastro" styleClass="selects" filter="true" filterMatchMode="contains"
                                     required="true" requiredMessage="Vacina da campanha é obrigatório"
                                     value="#{campanhaView.campanha.vacina.id}">
                        <f:selectItem itemLabel="Selecione uma vacina" itemValue="#{null}"/>
                        <f:selectItems value="#{campanhaView.listaDeVacinas}" var="vacina" itemLabel="#{vacina.nome}"
                                       itemValue="#{vacina.id}"/>
                    </p:selectOneMenu>
                </div>
            </div>

            <div class="agrupar-opicional">
                <div class="campo-opcional">
                    <p:outputLabel for="dataInicioCadastro" value="Data de inicío" styleClass="margin-label-bottom"/>
                    <p:calendar id="dataInicioCadastro" showOn="button" pattern="dd/MM/yyyy" mask="99/99/9999"
                                placeholder="__/__/____" size="20" value="#{campanhaView.campanha.dataInicio}"/>
                </div>

                <div class="campo-opcional">
                    <p:outputLabel for="dataFimCadastro" value="Data de término" styleClass="margin-label-bottom"/>
                    <p:calendar id="dataFimCadastro" showOn="button" pattern="dd/MM/yyyy" mask="99/99/9999"
                                placeholder="__/__/____" size="20" value="#{campanhaView.campanha.dataFim}"/>
                </div>
                <div class="campo-opcional">
                    <p:outputLabel for="idadeMinimaCadastro" value="Idade mínima" styleClass="margin-label-bottom"/>
                    <p:spinner id="idadeMinimaCadastro" size="15" value="#{campanhaView.campanha.idadeMinima}" min="0"/>
                </div>
                <div class="campo-opcional">
                    <p:outputLabel for="idadeMaximaCadastro" value="Idade máxima" styleClass="margin-label-bottom"/>
                    <p:spinner id="idadeMaximaCadastro" size="15" value="#{campanhaView.campanha.idadeMaxima}" min="0"/>
                </div>
            </div>

            <div class="botoes-dialogo  ">
                <p:commandButton icon="fa fa-close" value="Cancelar" styleClass="botao-cancelar"
                                 onclick="PF('dlgCadastroCampanha').hide()">
                    <p:ajax resetValues="true" update="@form"/>
                </p:commandButton>
                <p:commandButton icon="fa fa-save" value="Gravar" styleClass="botao-gravar"
                                 action="#{campanhaView.cadastrarCampanha}"
                                 update="@form, mensagem, :formTabCampanhas:tabCampanhas"/>
            </div>
        </h:form>
    </p:dialog>
</h:body>

</html>
